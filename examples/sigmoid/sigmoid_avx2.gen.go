// Code generated by hwygen. DO NOT EDIT.
//go:build amd64 && goexperiment.simd

package sigmoid

import (
	"github.com/go-highway/highway/hwy/contrib"
	"simd/archsimd"
)

func BaseSigmoid_avx2(in []float32, out []float32) {
	size := min(len(in), len(out))
	vOne := archsimd.BroadcastFloat32x8(float32(1))
	ii := 0
	for ; ii+8 <= size; ii += 8 {
		x := archsimd.LoadFloat32x8Slice(in[ii:])
		negX := archsimd.BroadcastFloat32x8(0).Sub(x)
		expNegX := contrib.Exp_AVX2_F32x8(negX)
		y := vOne.Div(vOne.Add(expNegX))
		y.StoreSlice(out[ii:])
	}
	if ii < size {
		BaseSigmoid_fallback(in[ii:size], out[ii:size])
	}
}

func BaseSigmoid_avx2_Float64(in []float64, out []float64) {
	size := min(len(in), len(out))
	vOne := archsimd.BroadcastFloat64x4(float64(1))
	ii := 0
	for ; ii+4 <= size; ii += 4 {
		x := archsimd.LoadFloat64x4Slice(in[ii:])
		negX := archsimd.BroadcastFloat64x4(0).Sub(x)
		expNegX := contrib.Exp_AVX2_F64x4(negX)
		y := vOne.Div(vOne.Add(expNegX))
		y.StoreSlice(out[ii:])
	}
	if ii < size {
		BaseSigmoid_fallback_Float64(in[ii:size], out[ii:size])
	}
}
