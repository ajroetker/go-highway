// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build amd64 && goexperiment.simd

package loss

import (
	"simd/archsimd"

	"github.com/ajroetker/go-highway/hwy"
)

var CutCrossEntropy func(hiddenStates []float32, embeddings []float32, labels []int32, numPositions int, hiddenDim int, vocabSize int) float32
var CutCrossEntropyGrad func(hiddenStates []float32, embeddings []float32, labels []int32, gradOutput []float32, numPositions int, hiddenDim int, vocabSize int)
var CutCrossEntropyWithLogits func(hiddenStates []float32, embeddings []float32, labels []int32, perPositionLoss []float32, correctLogits []float32, numPositions int, hiddenDim int, vocabSize int) float32

func init() {
	if hwy.NoSimdEnv() {
		initCutceFallback()
		return
	}
	if archsimd.X86.AVX512() {
		initCutceAVX512()
		return
	}
	if archsimd.X86.AVX2() {
		initCutceAVX2()
		return
	}
	initCutceFallback()
}

func initCutceAVX2() {
	// Use base implementations - they use hwy.* which provides SIMD acceleration
	CutCrossEntropy = BaseCutCrossEntropy
	CutCrossEntropyGrad = BaseCutCrossEntropyGrad
	CutCrossEntropyWithLogits = BaseCutCrossEntropyWithLogits
}

func initCutceAVX512() {
	// Use base implementations - they use hwy.* which provides SIMD acceleration
	CutCrossEntropy = BaseCutCrossEntropy
	CutCrossEntropyGrad = BaseCutCrossEntropyGrad
	CutCrossEntropyWithLogits = BaseCutCrossEntropyWithLogits
}

func initCutceFallback() {
	CutCrossEntropy = BaseCutCrossEntropy
	CutCrossEntropyGrad = BaseCutCrossEntropyGrad
	CutCrossEntropyWithLogits = BaseCutCrossEntropyWithLogits
}
