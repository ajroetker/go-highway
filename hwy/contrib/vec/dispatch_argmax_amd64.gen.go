// Code generated by hwygen. DO NOT EDIT.
//go:build amd64 && goexperiment.simd

package vec

import (
	"os"

	"github.com/ajroetker/go-highway/hwy"
)

var ArgmaxFloat16 func(v []hwy.Float16) int
var ArgmaxBFloat16 func(v []hwy.BFloat16) int
var ArgmaxFloat32 func(v []float32) int
var ArgmaxFloat64 func(v []float64) int
var ArgminFloat16 func(v []hwy.Float16) int
var ArgminBFloat16 func(v []hwy.BFloat16) int
var ArgminFloat32 func(v []float32) int
var ArgminFloat64 func(v []float64) int

// Argmax returns the index of the maximum value in a slice.
// Supports all float types: float32, float64, Float16, BFloat16.
// If multiple elements have the maximum value, returns the first occurrence.
// NaN values are skipped.
// Panics if the slice is empty.
func Argmax[T hwy.Floats](v []T) int {
	switch any(v).(type) {
	case []hwy.Float16:
		return ArgmaxFloat16(any(v).([]hwy.Float16))
	case []hwy.BFloat16:
		return ArgmaxBFloat16(any(v).([]hwy.BFloat16))
	case []float32:
		return ArgmaxFloat32(any(v).([]float32))
	case []float64:
		return ArgmaxFloat64(any(v).([]float64))
	}
	panic("unreachable")
}

// Argmin returns the index of the minimum value in a slice.
// Supports all float types: float32, float64, Float16, BFloat16.
// If multiple elements have the minimum value, returns the first occurrence.
// NaN values are skipped.
// Panics if the slice is empty.
func Argmin[T hwy.Floats](v []T) int {
	switch any(v).(type) {
	case []hwy.Float16:
		return ArgminFloat16(any(v).([]hwy.Float16))
	case []hwy.BFloat16:
		return ArgminBFloat16(any(v).([]hwy.BFloat16))
	case []float32:
		return ArgminFloat32(any(v).([]float32))
	case []float64:
		return ArgminFloat64(any(v).([]float64))
	}
	panic("unreachable")
}

func init() {
	if os.Getenv("HWY_NO_SIMD") != "" {
		initArgmaxFallback()
		return
	}
	// TODO: Add AVX2/AVX512 SIMD implementations
	// For now, use scalar fallback on x86-64
	initArgmaxFallback()
}

func initArgmaxFallback() {
	ArgmaxFloat32 = BaseArgmaxFloat32
	ArgmaxFloat64 = BaseArgmaxFloat64
	ArgmaxFloat16 = BaseArgmaxFloat16
	ArgmaxBFloat16 = BaseArgmaxBFloat16
	ArgminFloat32 = BaseArgminFloat32
	ArgminFloat64 = BaseArgminFloat64
	ArgminFloat16 = BaseArgminFloat16
	ArgminBFloat16 = BaseArgminBFloat16
}
