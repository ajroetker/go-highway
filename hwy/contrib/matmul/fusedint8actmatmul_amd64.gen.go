// Code generated by github.com/ajroetker/go-highway/cmd/hwygen. DO NOT EDIT.

//go:build amd64 && goexperiment.simd

package matmul

import (
	"simd/archsimd"

	"github.com/ajroetker/go-highway/hwy"
)

var FusedInt8MatMulSiLU func(input []float32, weights []int8, scales []float32, bias []float32, output []float32, M int, K int, N int, groupSize int)
var FusedInt8MatMulGELU func(input []float32, weights []int8, scales []float32, bias []float32, output []float32, M int, K int, N int, groupSize int)
var FusedInt8MatMulGELUApprox func(input []float32, weights []int8, scales []float32, bias []float32, output []float32, M int, K int, N int, groupSize int)
var FusedInt8MatMulReLU func(input []float32, weights []int8, scales []float32, bias []float32, output []float32, M int, K int, N int, groupSize int)

func init() {
	initFusedint8actmatmulAll()
}

func initFusedint8actmatmulAll() {
	if hwy.NoSimdEnv() {
		initFusedint8actmatmulFallback()
		return
	}
	if archsimd.X86.AVX512() {
		initFusedint8actmatmulAVX512()
		return
	}
	if archsimd.X86.AVX2() {
		initFusedint8actmatmulAVX2()
		return
	}
	initFusedint8actmatmulFallback()
}

func initFusedint8actmatmulAVX2() {
	FusedInt8MatMulSiLU = BaseFusedInt8MatMulSiLU_avx2
	FusedInt8MatMulGELU = BaseFusedInt8MatMulGELU_avx2
	FusedInt8MatMulGELUApprox = BaseFusedInt8MatMulGELUApprox_avx2
	FusedInt8MatMulReLU = BaseFusedInt8MatMulReLU_avx2
}

func initFusedint8actmatmulAVX512() {
	FusedInt8MatMulSiLU = BaseFusedInt8MatMulSiLU_avx512
	FusedInt8MatMulGELU = BaseFusedInt8MatMulGELU_avx512
	FusedInt8MatMulGELUApprox = BaseFusedInt8MatMulGELUApprox_avx512
	FusedInt8MatMulReLU = BaseFusedInt8MatMulReLU_avx512
}

func initFusedint8actmatmulFallback() {
	FusedInt8MatMulSiLU = BaseFusedInt8MatMulSiLU_fallback
	FusedInt8MatMulGELU = BaseFusedInt8MatMulGELU_fallback
	FusedInt8MatMulGELUApprox = BaseFusedInt8MatMulGELUApprox_fallback
	FusedInt8MatMulReLU = BaseFusedInt8MatMulReLU_fallback
}
