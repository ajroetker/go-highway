//go:build !noasm && arm64
// Code generated by hwygen -c. DO NOT EDIT.

package nn

import (
	"unsafe"

	"github.com/ajroetker/go-highway/hwy"
	"github.com/ajroetker/go-highway/hwy/contrib/nn/asm"
)

func init() {
	initLayernormNeonCAsm()
}

func initLayernormNeonCAsm() {
	if hwy.NoSimdEnv() {
		return
	}
	LayerNormFloat32 = layerNormAsmF32
	LayerNormFloat64 = layerNormAsmF64
	if hwy.HasARMFP16() {
		LayerNormFloat16 = layerNormAsmF16
	}
	if hwy.HasARMBF16() {
		LayerNormBFloat16 = layerNormAsmBF16
	}
}

func layerNormAsmF16(input, output []hwy.Float16, normSize int, gamma, beta []hwy.Float16, epsilon hwy.Float16) {
	var p_input unsafe.Pointer
	if len(input) > 0 {
		p_input = unsafe.Pointer(&input[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	var p_gamma unsafe.Pointer
	if len(gamma) > 0 {
		p_gamma = unsafe.Pointer(&gamma[0])
	}
	var p_beta unsafe.Pointer
	if len(beta) > 0 {
		p_beta = unsafe.Pointer(&beta[0])
	}
	normSizeVal := int64(normSize)
	epsilonVal := uint16(epsilon)
	len_inputVal := int64(len(input))
	len_outputVal := int64(len(output))
	len_gammaVal := int64(len(gamma))
	len_betaVal := int64(len(beta))
	asm.LayerNorm_F16(
		p_input,
		p_output,
		unsafe.Pointer(&normSizeVal),
		p_gamma,
		p_beta,
		unsafe.Pointer(&epsilonVal),
		unsafe.Pointer(&len_inputVal),
		unsafe.Pointer(&len_outputVal),
		unsafe.Pointer(&len_gammaVal),
		unsafe.Pointer(&len_betaVal),
	)
}

func layerNormAsmBF16(input, output []hwy.BFloat16, normSize int, gamma, beta []hwy.BFloat16, epsilon hwy.BFloat16) {
	var p_input unsafe.Pointer
	if len(input) > 0 {
		p_input = unsafe.Pointer(&input[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	var p_gamma unsafe.Pointer
	if len(gamma) > 0 {
		p_gamma = unsafe.Pointer(&gamma[0])
	}
	var p_beta unsafe.Pointer
	if len(beta) > 0 {
		p_beta = unsafe.Pointer(&beta[0])
	}
	normSizeVal := int64(normSize)
	epsilonVal := uint16(epsilon)
	len_inputVal := int64(len(input))
	len_outputVal := int64(len(output))
	len_gammaVal := int64(len(gamma))
	len_betaVal := int64(len(beta))
	asm.LayerNorm_BF16(
		p_input,
		p_output,
		unsafe.Pointer(&normSizeVal),
		p_gamma,
		p_beta,
		unsafe.Pointer(&epsilonVal),
		unsafe.Pointer(&len_inputVal),
		unsafe.Pointer(&len_outputVal),
		unsafe.Pointer(&len_gammaVal),
		unsafe.Pointer(&len_betaVal),
	)
}

func layerNormAsmF32(input, output []float32, normSize int, gamma, beta []float32, epsilon float32) {
	var p_input unsafe.Pointer
	if len(input) > 0 {
		p_input = unsafe.Pointer(&input[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	var p_gamma unsafe.Pointer
	if len(gamma) > 0 {
		p_gamma = unsafe.Pointer(&gamma[0])
	}
	var p_beta unsafe.Pointer
	if len(beta) > 0 {
		p_beta = unsafe.Pointer(&beta[0])
	}
	normSizeVal := int64(normSize)
	epsilonVal := epsilon
	len_inputVal := int64(len(input))
	len_outputVal := int64(len(output))
	len_gammaVal := int64(len(gamma))
	len_betaVal := int64(len(beta))
	asm.LayerNorm_F32(
		p_input,
		p_output,
		unsafe.Pointer(&normSizeVal),
		p_gamma,
		p_beta,
		unsafe.Pointer(&epsilonVal),
		unsafe.Pointer(&len_inputVal),
		unsafe.Pointer(&len_outputVal),
		unsafe.Pointer(&len_gammaVal),
		unsafe.Pointer(&len_betaVal),
	)
}

func layerNormAsmF64(input, output []float64, normSize int, gamma, beta []float64, epsilon float64) {
	var p_input unsafe.Pointer
	if len(input) > 0 {
		p_input = unsafe.Pointer(&input[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	var p_gamma unsafe.Pointer
	if len(gamma) > 0 {
		p_gamma = unsafe.Pointer(&gamma[0])
	}
	var p_beta unsafe.Pointer
	if len(beta) > 0 {
		p_beta = unsafe.Pointer(&beta[0])
	}
	normSizeVal := int64(normSize)
	epsilonVal := epsilon
	len_inputVal := int64(len(input))
	len_outputVal := int64(len(output))
	len_gammaVal := int64(len(gamma))
	len_betaVal := int64(len(beta))
	asm.LayerNorm_F64(
		p_input,
		p_output,
		unsafe.Pointer(&normSizeVal),
		p_gamma,
		p_beta,
		unsafe.Pointer(&epsilonVal),
		unsafe.Pointer(&len_inputVal),
		unsafe.Pointer(&len_outputVal),
		unsafe.Pointer(&len_gammaVal),
		unsafe.Pointer(&len_betaVal),
	)
}

