//go:build !noasm && arm64
// Code generated by hwygen -c. DO NOT EDIT.

package nn

import (
	"unsafe"

	"github.com/ajroetker/go-highway/hwy"
	"github.com/ajroetker/go-highway/hwy/contrib/nn/asm"
)

func init() {
	initDenseNeonCAsm()
}

func initDenseNeonCAsm() {
	if hwy.NoSimdEnv() || hwy.HasSME() {
		return
	}
	DenseFloat32 = denseAsmF32
	DenseFloat64 = denseAsmF64
	if hwy.HasARMFP16() {
		DenseFloat16 = denseAsmF16
	}
	if hwy.HasARMBF16() {
		DenseBFloat16 = denseAsmBF16
	}
}

func denseAsmF16(x, weight, bias, output []hwy.Float16, batchSize, inFeatures, outFeatures int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_weight unsafe.Pointer
	if len(weight) > 0 {
		p_weight = unsafe.Pointer(&weight[0])
	}
	var p_bias unsafe.Pointer
	if len(bias) > 0 {
		p_bias = unsafe.Pointer(&bias[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	outFeaturesVal := int64(outFeatures)
	len_xVal := int64(len(x))
	len_weightVal := int64(len(weight))
	len_biasVal := int64(len(bias))
	len_outputVal := int64(len(output))
	asm.Dense_F16(
		p_x,
		p_weight,
		p_bias,
		p_output,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&outFeaturesVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_weightVal),
		unsafe.Pointer(&len_biasVal),
		unsafe.Pointer(&len_outputVal),
	)
}

func denseAsmBF16(x, weight, bias, output []hwy.BFloat16, batchSize, inFeatures, outFeatures int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_weight unsafe.Pointer
	if len(weight) > 0 {
		p_weight = unsafe.Pointer(&weight[0])
	}
	var p_bias unsafe.Pointer
	if len(bias) > 0 {
		p_bias = unsafe.Pointer(&bias[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	outFeaturesVal := int64(outFeatures)
	len_xVal := int64(len(x))
	len_weightVal := int64(len(weight))
	len_biasVal := int64(len(bias))
	len_outputVal := int64(len(output))
	asm.Dense_BF16(
		p_x,
		p_weight,
		p_bias,
		p_output,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&outFeaturesVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_weightVal),
		unsafe.Pointer(&len_biasVal),
		unsafe.Pointer(&len_outputVal),
	)
}

func denseAsmF32(x, weight, bias, output []float32, batchSize, inFeatures, outFeatures int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_weight unsafe.Pointer
	if len(weight) > 0 {
		p_weight = unsafe.Pointer(&weight[0])
	}
	var p_bias unsafe.Pointer
	if len(bias) > 0 {
		p_bias = unsafe.Pointer(&bias[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	outFeaturesVal := int64(outFeatures)
	len_xVal := int64(len(x))
	len_weightVal := int64(len(weight))
	len_biasVal := int64(len(bias))
	len_outputVal := int64(len(output))
	asm.Dense_F32(
		p_x,
		p_weight,
		p_bias,
		p_output,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&outFeaturesVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_weightVal),
		unsafe.Pointer(&len_biasVal),
		unsafe.Pointer(&len_outputVal),
	)
}

func denseAsmF64(x, weight, bias, output []float64, batchSize, inFeatures, outFeatures int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_weight unsafe.Pointer
	if len(weight) > 0 {
		p_weight = unsafe.Pointer(&weight[0])
	}
	var p_bias unsafe.Pointer
	if len(bias) > 0 {
		p_bias = unsafe.Pointer(&bias[0])
	}
	var p_output unsafe.Pointer
	if len(output) > 0 {
		p_output = unsafe.Pointer(&output[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	outFeaturesVal := int64(outFeatures)
	len_xVal := int64(len(x))
	len_weightVal := int64(len(weight))
	len_biasVal := int64(len(bias))
	len_outputVal := int64(len(output))
	asm.Dense_F64(
		p_x,
		p_weight,
		p_bias,
		p_output,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&outFeaturesVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_weightVal),
		unsafe.Pointer(&len_biasVal),
		unsafe.Pointer(&len_outputVal),
	)
}

