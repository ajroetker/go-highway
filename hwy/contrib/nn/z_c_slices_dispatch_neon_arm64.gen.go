//go:build !noasm && arm64
// Code generated by hwygen -c. DO NOT EDIT.

package nn

import (
	"unsafe"

	"github.com/ajroetker/go-highway/hwy"
	"github.com/ajroetker/go-highway/hwy/contrib/nn/asm"
)

func init() {
	initNeonCAsm()
}

func initNeonCAsm() {
	if hwy.NoSimdEnv() || hwy.HasSME() {
		return
	}
	QKVDenseFloat32 = qKVDenseAsmF32
	QKVDenseFloat64 = qKVDenseAsmF64
	if hwy.HasARMFP16() {
		QKVDenseFloat16 = qKVDenseAsmF16
	}
	if hwy.HasARMBF16() {
		QKVDenseBFloat16 = qKVDenseAsmBF16
	}
}

func qKVDenseAsmF16(x, wQKV, biasQ, biasK, biasV, q, k, v []hwy.Float16, batchSize, inFeatures, qDim, kvDim int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_wQKV unsafe.Pointer
	if len(wQKV) > 0 {
		p_wQKV = unsafe.Pointer(&wQKV[0])
	}
	var p_biasQ unsafe.Pointer
	if len(biasQ) > 0 {
		p_biasQ = unsafe.Pointer(&biasQ[0])
	}
	var p_biasK unsafe.Pointer
	if len(biasK) > 0 {
		p_biasK = unsafe.Pointer(&biasK[0])
	}
	var p_biasV unsafe.Pointer
	if len(biasV) > 0 {
		p_biasV = unsafe.Pointer(&biasV[0])
	}
	var p_q unsafe.Pointer
	if len(q) > 0 {
		p_q = unsafe.Pointer(&q[0])
	}
	var p_k unsafe.Pointer
	if len(k) > 0 {
		p_k = unsafe.Pointer(&k[0])
	}
	var p_v unsafe.Pointer
	if len(v) > 0 {
		p_v = unsafe.Pointer(&v[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	qDimVal := int64(qDim)
	kvDimVal := int64(kvDim)
	len_xVal := int64(len(x))
	len_wQKVVal := int64(len(wQKV))
	len_biasQVal := int64(len(biasQ))
	len_biasKVal := int64(len(biasK))
	len_biasVVal := int64(len(biasV))
	len_qVal := int64(len(q))
	len_kVal := int64(len(k))
	len_vVal := int64(len(v))
	asm.QKVDense_F16(
		p_x,
		p_wQKV,
		p_biasQ,
		p_biasK,
		p_biasV,
		p_q,
		p_k,
		p_v,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&qDimVal),
		unsafe.Pointer(&kvDimVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_wQKVVal),
		unsafe.Pointer(&len_biasQVal),
		unsafe.Pointer(&len_biasKVal),
		unsafe.Pointer(&len_biasVVal),
		unsafe.Pointer(&len_qVal),
		unsafe.Pointer(&len_kVal),
		unsafe.Pointer(&len_vVal),
	)
}

func qKVDenseAsmBF16(x, wQKV, biasQ, biasK, biasV, q, k, v []hwy.BFloat16, batchSize, inFeatures, qDim, kvDim int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_wQKV unsafe.Pointer
	if len(wQKV) > 0 {
		p_wQKV = unsafe.Pointer(&wQKV[0])
	}
	var p_biasQ unsafe.Pointer
	if len(biasQ) > 0 {
		p_biasQ = unsafe.Pointer(&biasQ[0])
	}
	var p_biasK unsafe.Pointer
	if len(biasK) > 0 {
		p_biasK = unsafe.Pointer(&biasK[0])
	}
	var p_biasV unsafe.Pointer
	if len(biasV) > 0 {
		p_biasV = unsafe.Pointer(&biasV[0])
	}
	var p_q unsafe.Pointer
	if len(q) > 0 {
		p_q = unsafe.Pointer(&q[0])
	}
	var p_k unsafe.Pointer
	if len(k) > 0 {
		p_k = unsafe.Pointer(&k[0])
	}
	var p_v unsafe.Pointer
	if len(v) > 0 {
		p_v = unsafe.Pointer(&v[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	qDimVal := int64(qDim)
	kvDimVal := int64(kvDim)
	len_xVal := int64(len(x))
	len_wQKVVal := int64(len(wQKV))
	len_biasQVal := int64(len(biasQ))
	len_biasKVal := int64(len(biasK))
	len_biasVVal := int64(len(biasV))
	len_qVal := int64(len(q))
	len_kVal := int64(len(k))
	len_vVal := int64(len(v))
	asm.QKVDense_BF16(
		p_x,
		p_wQKV,
		p_biasQ,
		p_biasK,
		p_biasV,
		p_q,
		p_k,
		p_v,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&qDimVal),
		unsafe.Pointer(&kvDimVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_wQKVVal),
		unsafe.Pointer(&len_biasQVal),
		unsafe.Pointer(&len_biasKVal),
		unsafe.Pointer(&len_biasVVal),
		unsafe.Pointer(&len_qVal),
		unsafe.Pointer(&len_kVal),
		unsafe.Pointer(&len_vVal),
	)
}

func qKVDenseAsmF32(x, wQKV, biasQ, biasK, biasV, q, k, v []float32, batchSize, inFeatures, qDim, kvDim int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_wQKV unsafe.Pointer
	if len(wQKV) > 0 {
		p_wQKV = unsafe.Pointer(&wQKV[0])
	}
	var p_biasQ unsafe.Pointer
	if len(biasQ) > 0 {
		p_biasQ = unsafe.Pointer(&biasQ[0])
	}
	var p_biasK unsafe.Pointer
	if len(biasK) > 0 {
		p_biasK = unsafe.Pointer(&biasK[0])
	}
	var p_biasV unsafe.Pointer
	if len(biasV) > 0 {
		p_biasV = unsafe.Pointer(&biasV[0])
	}
	var p_q unsafe.Pointer
	if len(q) > 0 {
		p_q = unsafe.Pointer(&q[0])
	}
	var p_k unsafe.Pointer
	if len(k) > 0 {
		p_k = unsafe.Pointer(&k[0])
	}
	var p_v unsafe.Pointer
	if len(v) > 0 {
		p_v = unsafe.Pointer(&v[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	qDimVal := int64(qDim)
	kvDimVal := int64(kvDim)
	len_xVal := int64(len(x))
	len_wQKVVal := int64(len(wQKV))
	len_biasQVal := int64(len(biasQ))
	len_biasKVal := int64(len(biasK))
	len_biasVVal := int64(len(biasV))
	len_qVal := int64(len(q))
	len_kVal := int64(len(k))
	len_vVal := int64(len(v))
	asm.QKVDense_F32(
		p_x,
		p_wQKV,
		p_biasQ,
		p_biasK,
		p_biasV,
		p_q,
		p_k,
		p_v,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&qDimVal),
		unsafe.Pointer(&kvDimVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_wQKVVal),
		unsafe.Pointer(&len_biasQVal),
		unsafe.Pointer(&len_biasKVal),
		unsafe.Pointer(&len_biasVVal),
		unsafe.Pointer(&len_qVal),
		unsafe.Pointer(&len_kVal),
		unsafe.Pointer(&len_vVal),
	)
}

func qKVDenseAsmF64(x, wQKV, biasQ, biasK, biasV, q, k, v []float64, batchSize, inFeatures, qDim, kvDim int) {
	var p_x unsafe.Pointer
	if len(x) > 0 {
		p_x = unsafe.Pointer(&x[0])
	}
	var p_wQKV unsafe.Pointer
	if len(wQKV) > 0 {
		p_wQKV = unsafe.Pointer(&wQKV[0])
	}
	var p_biasQ unsafe.Pointer
	if len(biasQ) > 0 {
		p_biasQ = unsafe.Pointer(&biasQ[0])
	}
	var p_biasK unsafe.Pointer
	if len(biasK) > 0 {
		p_biasK = unsafe.Pointer(&biasK[0])
	}
	var p_biasV unsafe.Pointer
	if len(biasV) > 0 {
		p_biasV = unsafe.Pointer(&biasV[0])
	}
	var p_q unsafe.Pointer
	if len(q) > 0 {
		p_q = unsafe.Pointer(&q[0])
	}
	var p_k unsafe.Pointer
	if len(k) > 0 {
		p_k = unsafe.Pointer(&k[0])
	}
	var p_v unsafe.Pointer
	if len(v) > 0 {
		p_v = unsafe.Pointer(&v[0])
	}
	batchSizeVal := int64(batchSize)
	inFeaturesVal := int64(inFeatures)
	qDimVal := int64(qDim)
	kvDimVal := int64(kvDim)
	len_xVal := int64(len(x))
	len_wQKVVal := int64(len(wQKV))
	len_biasQVal := int64(len(biasQ))
	len_biasKVal := int64(len(biasK))
	len_biasVVal := int64(len(biasV))
	len_qVal := int64(len(q))
	len_kVal := int64(len(k))
	len_vVal := int64(len(v))
	asm.QKVDense_F64(
		p_x,
		p_wQKV,
		p_biasQ,
		p_biasK,
		p_biasV,
		p_q,
		p_k,
		p_v,
		unsafe.Pointer(&batchSizeVal),
		unsafe.Pointer(&inFeaturesVal),
		unsafe.Pointer(&qDimVal),
		unsafe.Pointer(&kvDimVal),
		unsafe.Pointer(&len_xVal),
		unsafe.Pointer(&len_wQKVVal),
		unsafe.Pointer(&len_biasQVal),
		unsafe.Pointer(&len_biasKVal),
		unsafe.Pointer(&len_biasVVal),
		unsafe.Pointer(&len_qVal),
		unsafe.Pointer(&len_kVal),
		unsafe.Pointer(&len_vVal),
	)
}

